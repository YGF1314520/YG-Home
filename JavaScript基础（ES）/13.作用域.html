<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>作用域</title>
</head>

<body>
    <script>
        /* JavaScript作用域：就是变量在某个范围内起作用和效果 目的是为了提高程序的可靠性 更重要的是减少命名冲突 */
        // 1.js的作用域(es6)之前：全局作用域 局部作用域
        // 2.全局作用域：整个script标签 或者是一个单独的js文件
        var num = 10;
        var num = 30;
        console.log(num);
        // 3.局部作用域(函数作用域) 在函数内部就是局部作用域 这个代码的名字只在函数内部起效果和作用
        function fn() {
            // 局部作用域
            var num = 20;
            console.log(num);
        }
        fn();

        /* 变量的作用域:根据作用域的不同我们变量分为全局变量和局部变量 */
        // 1.全局变量：在全局作用域下的变量
        // 注意：如果在函数内部 没有声明直接赋值的变量也属于全局变量
        var num1 = 10; //num就是一个全局变量
        console.log(num1);
        function fun1() {
            console.log(num1);
        }
        fun1();

        // console.log(aru);
        // 2.局部变量 在局部作用域下的变量 后者在函数内部的变量就是 局部变量
        // 注意：函数的形参也可以看作是 局部变量
        function fun2(aru) {
            var num2 = 10; //num2就是局部变量 只能在函数内部调用
            num3 = 20;
        }
        fun2();
        // console.log(num2);
        // console.log(num3);

        // 3.从执行效率来看全局变量和局部变量
        // (1)全局变量只有浏览器关闭的时候才会销毁，比较占内存资源
        // (2)局部变量 当我们程序执行完毕就会全部销毁，比较节约内存资源。

        /* 作用域链:内部函数访问外部函数的变量，采取的是链式查找的方式来决定取哪个值 这种结构我们称作作用域链 就近原则*/
        var num4 = 40;
        function fnW() { //外部函数
            var num4 = 50;
            function fnN() { //内部函数
                var num4 = 0;
                console.log(num4);//0
                // console.log(num4);//50  //站在目标出发，一级一级往外查找
            }
            fnN();
        }
        fnW();

        // 比较复杂的作用域链
        var a = 1;
        function f1() {
            var a = 2;
            var b = '22';
            f2();
            function f2() {
                var a = 3;
                f3();
                function f3() {
                    var a = 4;
                    console.log(a); //4  //找局部作用域，离他最近的
                    console.log(b); //22 //找全局作用域，b未被从新赋值。
                }
            }
        }
        f1();
    </script>

    <script>
        /* 作用域 补充知识 */

        // js在es6 之前 没有块级作用域 只有全局作用域和局部作用域 
        //  全局作用域： 在函数外部定义的变量(在任何地方都能使用)  在函数内部定义的变量我们成为局部变量
        //   调用函数时会优先使用函数内部的变量 没有的话在找全局变量  函数内部变量的声明也会提前

        var num = 1;
        function add() {
            var num = 2;
            console.log(num);
            num++;
            return num;
        }
        console.log(add());
        console.log(num);
//
//    var num ;
//    function add(){

//        num=2;
//        console.log(num);
//        num++;
//        return num;
//        var num;
//    }
//  num=1;
//  console.log(add());
//  console.log(num);
    </script>

    <script>
        /* 作用域 【进阶】 */

        // 作用域是：变脸的使用范围就是作用域
        // 数据 变量 函数 作用域 

        // 代码
        // 关键字 运算符 数据 变量

        // 变量：作用：保存数据 
        // 1: 声明  关键字 var  let const 
        // 2: 使用  用的时候赋值是什么？js数据
        // 3: 存值（赋值）  关键看 赋值运算符  = += 


        // 变量的使用规则
        // 哪一个作用域中的变量：在自己的作用域中找 var ，如果没有去祖籍作用中找，直到找到var位置，
        // 使用的值，在使用的这行，代码网上找，找到最近的一次赋值。



        var test = 123;

        var test;   // 定义
        test = 123  // 使用---> 对变量重新赋值
        console.log(test);  // 使用  用变量中存放的数据
        test = '';

        // 如何判断变量是由的是哪一个值？


        console.log(a);


        // window
        var a = 1;
        var b;
        let q = 123

        function foo(params) {
            // foo 
            var c;

            function bar(params) {
                // bar 
                var d;

                // 作用：变量e 重新赋值
                e = 123;
                console.log(a);
                // console.log(f);

            }
            bar();
            call()
            function call(params) {
                var f;
            }



        }

        foo();


    </script>
</body>

</html>